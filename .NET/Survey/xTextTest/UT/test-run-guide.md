# 標準.NETフレームワークによるxTextテスト実行ガイド

このガイドでは、MSTestなどのテストフレームワークを使わずに作成した単体テストプログラムの使用方法を説明します。

## プロジェクト設定

### 1. コンソールアプリケーションプロジェクトの作成

1. Visual Studioで「ファイル」→「新規作成」→「プロジェクト」を選択
2. 「コンソールアプリケーション」テンプレートを選択
3. プロジェクト名（例：「xTextTestConsole」）を入力して作成

### 2. 必要な参照の追加

以下の参照をプロジェクトに追加します：
- System.Windows.Forms
- System.Drawing
- xTextコントロールライブラリ（xTextが含まれるプロジェクト）

参照の追加方法：
1. ソリューションエクスプローラーでプロジェクトを右クリック
2. 「参照の追加」を選択
3. 「参照マネージャー」ダイアログで必要な参照を追加

### 3. アプリケーション設定の変更

Windows FormsコントロールをテストするためSTAスレッドモデルを使用するよう設定：

1. プロジェクトのプロパティを開く
2. 「アプリケーション」タブを選択
3. 「出力の種類」が「コンソールアプリケーション」になっていることを確認
4. 「詳細設定」ボタンをクリック
5. 「スレッドモデル」を「シングルスレッドアパートメント [STA]」に設定

## テストコードの実装

1. 提供されたテストコードを新しいファイル（例：`xTextTests.vb`）に追加
2. xTextクラスが正しく参照されていることを確認

## テストの実行

### コンソールからの実行

1. プロジェクトをビルド（メニュー「ビルド」→「ソリューションのビルド」）
2. 実行（F5キー）

テストプログラムが起動し、各テストが順番に実行されます。テスト結果はコンソールウィンドウに表示されます。

### テスト実行時の注意点

1. **クリップボードアクセス**：
   - テストプログラムはクリップボードを使用します
   - テスト実行中は他のアプリケーションでクリップボードを使わないようにしてください
   - リモートデスクトップ環境などでは、クリップボードアクセスに制限がある場合があります

2. **UI操作**：
   - テストはUIスレッド上で実行する必要があります
   - `Application.DoEvents()`の呼び出しでUIイベント処理を確実に行っています

3. **テスト結果の解釈**：
   - 成功したテストは「成功」と表示されます
   - 失敗したテストは「失敗」と表示され、失敗したテスト一覧が最後に表示されます
   - 例外が発生した場合はエラーメッセージが表示されます

## テストのカスタマイズ

### 新しいテストの追加

1. `#Region "テストメソッド"` 内に新しいテストメソッドを追加：
   ```vb
   Function Test_新しいテスト名(testForm As TestForm) As Boolean
       ' テスト内容を実装
       Return Assert(条件, "失敗時のメッセージ")
   End Function
   ```

2. `RunAllTests()` メソッド内でテストを呼び出すコードを追加：
   ```vb
   RunTest(testForm, "新しいテスト名", AddressOf Test_新しいテスト名)
   ```

### テスト条件の変更

既存のテストメソッド内の条件やパラメーターを必要に応じて変更できます。例えば：
- MaxLengthBの値を変更
- テスト用文字列の内容を変更
- アサート条件を調整

## トラブルシューティング

1. **クリップボード関連のエラー**：
   - クリップボード操作に失敗した場合、テストはスキップされます
   - コードでは例外をキャッチして「テストをスキップします」メッセージを表示します

2. **リフレクション関連のエラー**：
   - xTextクラスの内部実装が変更された場合、リフレクションによるメソッド呼び出しが失敗する可能性があります
   - エラーメッセージを確認し、必要に応じてリフレクション呼び出しコードを更新してください

3. **テストフォームの不具合**：
   - テストフォームの初期化に失敗する場合は、フォームの作成方法を確認してください
   - UIスレッドの問題が疑われる場合は、STAスレッド設定を確認してください

## エンコーディング確認

Shift-JISエンコーディングに関連するテストでは、システムのロケール設定が重要です。
日本語環境での実行を推奨します。



■ファイル一覧
dir /b /s > all.txt



■クラッシュダンプを取得

### 1. Windows Error Reporting (WER) を利用する方法

Windowsは、クラッシュ時に自動的にダンプファイルを作成するように設定できます。設定手順は以下の通りです。

1. **レジストリでダンプ設定を行う**  
   1. 「regedit」を管理者権限で実行します。  
   2. 次のキーに移動します:  
      ```
      HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\Windows Error Reporting\LocalDumps
      ```
   3. キーが存在しない場合は、新しく作成してください（右クリック→新規→キー）。  
   4. 以下の値を設定します（新規作成が必要な場合は右クリック→新規→DWORDまたは文字列値）：
      - **DumpFolder (REG_EXPAND_SZ)**  
        → ダンプファイルを保存するフォルダのパス（例: `C:\CrashDumps`）
      - **DumpCount (DWORD)**  
        → 保存するダンプファイルの最大数（例: `10`）
      - **DumpType (DWORD)**  
        → ダンプの種類。  
        - 1：小さいダンプ（最小限の情報）  
        - 2：フルダンプ（詳細な情報）  
        → スタックトレースの解析に役立つため、通常は「2」を設定します。

3. **アプリケーションのクラッシュを再現する**  
   - 設定後、アプリケーションがクラッシュすると、指定したフォルダにダンプファイル（.dmp）が保存されます。

---

### 2. ProcDump ユーティリティを利用する方法

Microsoftが提供する無料のツール「ProcDump」を使うと、特定のプロセスのダンプを簡単に取得できます。

1. **ProcDumpのダウンロード**  
   - [Microsoft Sysinternalsのサイト](https://learn.microsoft.com/ja-jp/sysinternals/downloads/procdump)から「ProcDump」をダウンロードし、適当なフォルダに展開します。

2. **コマンドプロンプトを管理者権限で実行**  
   - 管理者権限でコマンドプロンプトを開き、ProcDumpのあるフォルダに移動します。

3. **クラッシュ時のダンプ取得のコマンド例**  
   - 例えば、プロセス名が「MyApp.exe」の場合、次のように実行します：
     ```
     procdump -ma MyApp.exe C:\CrashDumps\MyApp.dmp
     ```
     - `-ma` は「フルダンプ」を取得するオプションです。
     - ダンプファイルは指定したパスに保存されます。

4. **クラッシュのタイミングに合わせて**  
   - ProcDumpはリアルタイムでプロセスを監視し、例外やクラッシュが発生したときにダンプを取得できます。  
   - 例えば、例外発生時にダンプを取得する場合は、次のようにオプションを追加できます：
     ```
     procdump -ma -e MyApp.exe C:\CrashDumps\MyApp.dmp
     ```
     - `-e` は例外発生時にダンプを取るオプションです。

